_**ДИСКЛЕЙМЕР. Это черновой вариант, в файле наверняка присутствуют дофигища ошибок**_